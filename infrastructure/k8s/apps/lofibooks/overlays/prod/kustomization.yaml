apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: lofibooks

resources:
  - ../../base
  - namespace.yaml
  - workload-sa.yaml
  - secret-provider-class.yaml
  - ingress.yaml

# Patch backend environment variables with prod values
patches:
  - path: patches/backend-env.yaml
    target:
      kind: Deployment
      name: lofibooks-api

# Image tags are set by deploy-preprod.yml / deploy-prod.yml CI/CD workflows
# via `kubectl set image` after kustomize apply
